---
layout:     post
title:      "「机器学习」 扩散模型"
subtitle:   "Diffusion Models"
date:       2023-04-07 12:00:00
author:     "Azaan"
header-img: "img/post-bg-machine-learning.jpg"
katex: true
tags:
    - 机器学习
---





> 本文系MIT深度学习综述手册《Understanding Deep Learning》学习笔记
>

# 简介


扩散模型（diffusion model）是一种由编码器和解码器组成的模型。编码器获取数据样本 $\mathbf{x}$ 并将其映射到一系列中间隐变量 $\mathbf{z_1,...,z_T}$ 。解码器反转这个过程，从 $\mathbf{z_T}$ 开始并通过 $\mathbf{z_{T-1},...,z_1}$ 映射回来，直到它最终重新生成一个 $\mathbf{x}$ 。在编码器和解码器中，映射都是随机的而不是确定性的。

![](https://azaan-zheng.github.io/img/machine-learning/20230407/1.jpg)

如上图，编码器是预先确定的，它逐渐将输入和白噪声样本混合，通过足够多的步数，最终隐变量的条件分布 $\mathbf{q(z_T|x)}$ 和 边际分布 $\mathbf{q(z_T)}$ 都成为标准正态分布。编码器的随机性是指它不是直接输出一个确定的随机变量 $\mathbf{z_T}$，而是输出一个概率分布  $\mathbf{q(z_T|x)}$  的参数，比如均值和方差。然后，我们可以从这个分布中采样一个随机变量xT，并用解码器重建数据。

编码器的过程是预先指定的，它的作用是将输入数据逐渐加入白噪声，直到变成一个简单的概率分布（比如标准正态分布）。这个过程不需要学习任何参数，只需要确定每一步加入多少噪声，所有学习的参数都在解码器中。在解码器中，训练了一系列网络以在每个相邻的隐变量 $\mathbf{z_t}$ 和 $\mathbf{z_{t-1}}$ 之间向后映射。损失函数鼓励每个网络反转对应的解码器步骤，使得噪声逐渐从表示中去除，直到保留看起来逼真的数据示例。如果想要生成一个新的数据样本，我们可以直接从 $\mathbf{q(z_T)}$ 中采样然后将其送入解码器。







### 参考文献

1. 《Understanding Deep Learning》Simon J.D. Prince
2.   The Annotated Diffusion Model  https://huggingface.co/blog/annotated-diffusion



